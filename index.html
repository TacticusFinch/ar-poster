<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="utf-8">
  <title>AR-постер «Магический шахматный маг»</title>

  <!-- Правильное масштабирование на мобильных -->
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">

  <!-- A-Frame и MindAR -->
  <script src="https://cdn.jsdelivr.net/npm/aframe@1.4.2/dist/aframe.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.4/dist/mindar-image-aframe.prod.js"></script>

  <style>
    html,body {margin:0;overflow:hidden;background:#000;}
    /* Выравниваем канвас по окну, убираем артефакты прокрутки */
    #ar-scene canvas {position:absolute;top:0;left:0;}
  </style>
</head>

<body>
  <!-- AR-сцена -->
  <a-scene id="ar-scene"
           mindar-image="imageTargetSrc: targets.mind"
           embedded
           color-space="sRGB"
           renderer="colorManagement:true,physicallyCorrectLights"
           vr-mode-ui="enabled:false"
           device-orientation-permission-ui="enabled:true">

    <!-- Камера от MindAR -->
    <a-camera look-controls="enabled:false"></a-camera>

    <!-- Привязка ко всему постеру (0-й таргет в targets.mind) -->
    <a-entity mindar-image-target="targetIndex:0">

      <!-- Кнопка «Играть» -->
      <a-plane id="playBtn"
               class="clickable"
               position="0 0.35 0"   <!-- Чуть выше центра -->
               width="0.9" height="0.25"
               material="color:#2b9aff;opacity:0.85;shader:flat"
               animation="property:scale;dir:alternate;dur:800;from:1 1 1;to:1.1 1.1 1.1;loop:true;easing:easeInOutSine">
        <a-text value="Играть" align="center" color="#fff" width="2" position="0 0 0.01"></a-text>
      </a-plane>

      <!-- Кнопка «Записаться» -->
      <a-plane id="signBtn"
               class="clickable"
               position="0 -0.10 0"  <!-- Чуть ниже центра -->
               width="0.9" height="0.25"
               material="color:#ff6c00;opacity:0.85;shader:flat"
               animation="property:scale;dir:alternate;dur:800;delay:400;from:1 1 1;to:1.1 1.1 1.1;loop:true;easing:easeInOutSine">
        <a-text value="Записаться" align="center" color="#fff" width="2" position="0 0 0.01"></a-text>
      </a-plane>

    </a-entity>

    <!-- Курсор-луч, чтобы клики работали как на мобильном, так и мышкой -->
    <a-entity cursor="fuse:false;rayOrigin:mouse"
              raycaster="objects:.clickable"></a-entity>
  </a-scene>

  <!-- Слушатели нажатий -->
  <script>
    AFRAME.registerComponent('open-link-on-click', {
      schema: {url: {type:'string'}},
      init() {
        this.el.addEventListener('click', () => {
          window.location.href = this.data.url;
        });
      }
    });

    // Привязываем компонент к кнопкам
    document.addEventListener('DOMContentLoaded', () => {
      document.querySelector('#playBtn')
              .setAttribute('open-link-on-click','url:https://lichess.org/ru/learn');
      document.querySelector('#signBtn')
              .setAttribute('open-link-on-click','url:https://t.me/m/s_Zqu21RY2Yy');
    });
  </script>
</body>
</html>
